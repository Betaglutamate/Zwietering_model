}
test <- chol_beta_final %>% group_by(sample) %>% group_split() %>% map(calculate_growthrate)
growthrates_chol_beta <- chol_beta_final %>% group_by(sample) %>% group_split() %>% map(calculate_growthrate)
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(calculate_growthrate)
growthrates_chol_beta
growthrates_chol_beta
chol_beta_final
return(new_df)
##function to calculate growthrate
calculate_growthrate <- function(df) {
growthrate <- test1 %>%
filter(value > 0.02 & value < 0.1) %>%
lm(log(value)~Time, data = .)
growthrate <- growthrate$coefficients[[2]]
new_df <- tibble(sample= unique(df$sample))
return(new_df)
}
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(calculate_growthrate)
growthrates_chol_beta
##function to calculate growthrate
calculate_growthrate <- function(df) {
growthrate <- test1 %>%
filter(value > 0.02 & value < 0.1) %>%
lm(log(value)~Time, data = .)
growthrate <- growthrate$coefficients[[2]]
new_df <- tibble(sample= unique(df$sample), growth_rate = growthrate)
return(new_df)
}
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(calculate_growthrate) %>%
bind_rows()
growthrates_chol_beta
##function to calculate growthrate
calculate_growthrate <- function(df) {
growthrate <- df %>%
filter(value > 0.02 & value < 0.1) %>%
lm(log(value)~Time, data = .)
growthrate <- growthrate$coefficients[[2]]
new_df <- tibble(sample= unique(df$sample), growth_rate = growthrate)
return(new_df)
}
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(calculate_growthrate) %>%
bind_rows()
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map( possibly(calculate_growthrate)) %>%
bind_rows()
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(safely(calculate_growthrate)) %>%
bind_rows()
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(possibly(calculate_growthrate), , otherwise = NA) %>%
bind_rows()
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(possibly(calculate_growthrate), otherwise = NA) %>%
bind_rows()
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(possibly(calculate_growthrate, otherwise = NA)) %>%
bind_rows()
##function to calculate growthrate
calculate_growthrate <- function(df) {
growthrate <- df %>%
filter(value > 0.02 & value < 0.1) %>%
possibly(lm(log(value)~Time, data = .), otherwise = NA)
growthrate <- growthrate$coefficients[[2]]
new_df <- tibble(sample= unique(df$sample), growth_rate = growthrate)
return(new_df)
}
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(calculate_growthrate) %>%
bind_rows()
##function to calculate growthrate
calculate_growthrate <- function(df) {
growthrate <- df %>%
filter(value > 0.02 & value < 0.1) %>%
lm(log(value)~Time, data = .)
# growthrate <- growthrate$coefficients[[2]]
new_df <- tibble(sample= unique(df$sample), growth_rate = growthrate)
return(new_df)
}
##function to calculate growthrate
calculate_growthrate <- function(df) {
growthrate <- test1 %>%
filter(value > 0.02 & value < 0.1) %>%
lm(log(value)~Time, data = .)
# growthrate <- growthrate$coefficients[[2]]
new_df <- tibble(sample= unique(df$sample), growth_rate = growthrate)
return(new_df)
}
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(calculate_growthrate) %>%
bind_rows()
##function to calculate growthrate
calculate_growthrate <- function(df) {
growthrate <- test1 %>%
filter(value > 0.02 & value < 0.1) %>%
lm(log(value)~Time, data = .)
growthrate <- growthrate$coefficients[[2]]
new_df <- tibble(sample= unique(df$sample), growth_rate = growthrate)
return(new_df)
}
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(calculate_growthrate) %>%
bind_rows()
##function to calculate growthrate
calculate_growthrate <- possibly(function(df) {
growthrate <- df %>%
filter(value > 0.02 & value < 0.1) %>%
lm(log(value)~Time, data = .)
growthrate <- growthrate$coefficients[[2]]
new_df <- tibble(sample= unique(df$sample), growth_rate = growthrate)
return(new_df)},
otherwise = NA)
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(calculate_growthrate) %>%
bind_rows()
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(calculate_growthrate)
growthrates_chol_beta
##function to calculate growthrate
calculate_growthrate <- possibly(function(df) {
growthrate <- df %>%
filter(value > 0.02 & value < 0.05) %>%
lm(log(value)~Time, data = .)
growthrate <- growthrate$coefficients[[2]]
new_df <- tibble(sample= unique(df$sample), growth_rate = growthrate)
return(new_df)},
otherwise = NA)
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(calculate_growthrate)
growthrates_chol_beta
##function to calculate growthrate
calculate_growthrate <- possibly(function(df) {
growthrate <- df %>%
filter(value > 0.02 & value < 0.1) %>%
lm(log(value)~Time, data = .)
growthrate <- growthrate$coefficients[[2]]
new_df <- tibble(sample= unique(df$sample), growth_rate = growthrate)
return(new_df)},
otherwise = NA)
##function to calculate growthrate
calculate_growthrate <- possibly(function(df) {
growthrate <- df %>%
filter(value > 0.02 & value < 0.1) %>%
lm(log(value)~Time, data = .)
growthrate <- growthrate$coefficients[[2]]
new_df <- tibble(sample= unique(df$sample), growth_rate = growthrate)
return(new_df)},
otherwise = tibble(sample= unique(df$sample), growth_rate = NA))
##function to calculate growthrate
calculate_growthrate <- possibly(function(df) {
growthrate <- df %>%
filter(value > 0.02 & value < 0.1) %>%
lm(log(value)~Time, data = .)
growthrate <- growthrate$coefficients[[2]]
new_df <- tibble(sample= unique(df$sample), growth_rate = growthrate)
return(new_df)},
otherwise = tibble(sample= "unknown", growth_rate = NA))
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(calculate_growthrate)
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(calculate_growthrate) %>%
bind_rows()
growthrates_chol_beta
##function to calculate growthrate
calculate_growthrate <- possibly(function(df) {
growthrate <- df %>%
filter(value > 0.04 & value < 0.1) %>%
lm(log(value)~Time, data = .)
growthrate <- growthrate$coefficients[[2]]
new_df <- tibble(sample= unique(df$sample), growth_rate = growthrate)
return(new_df)},
otherwise = tibble(sample= "unknown", growth_rate = NA))
growthrates_chol_beta <-
chol_beta_final %>%
group_by(sample) %>%
group_split() %>%
map(calculate_growthrate) %>%
bind_rows()
growthrates_chol_beta
chol_beta_final
chol_beta_final %>%
group_by(sample) %>%
filter(Osmolarity == 0 & value < 0.2 & value> 0.05)
chol_beta_final %>%
group_by(sample) %>%
filter(Osmolarity == 0 & value < 0.2 & value> 0.05) %>%
ggplot(aes(x=Time, y=value, color=sample))+
geom_point()
chol_beta_final %>%
group_by(sample) %>%
filter(Osmolarity == 0 & value < 0.2 & value> 0.05) %>%
ggplot(aes(x=Time, y=value, color=sample))+
geom_point()+
xlim(0, 10)
chol_beta_final %>%
group_by(sample) %>%
filter(Osmolarity == 0 & value < 0.2 & value> 0.05) %>%
ggplot(aes(x=Time, y=value, color=sample))+
geom_point()+
xlim(5, 10)
chol_beta_final %>%
group_by(sample) %>%
filter(Osmolarity == 0 & value < 0.2 & value> 0.1) %>%
ggplot(aes(x=Time, y=value, color=sample))+
geom_point()+
xlim(5, 10)
chol_beta_final %>%
group_by(sample) %>%
filter(Osmolarity == 0 & value < 0.4 & value> 0.1) %>%
ggplot(aes(x=Time, y=value, color=sample))+
geom_point()+
xlim(5, 10)
chol_beta_final %>%
group_by(sample) %>%
filter(Osmolarity == 0 & value < 0.4 & value> 0.1) %>%
ggplot(aes(x=Time, y=value, color=sample))+
geom_point()+
xlim(8, 20)
chol_beta_final %>%
group_by(sample) %>%
filter(Osmolarity == 0 & value < 0.4 & value> 0.1) %>%
ggplot(aes(x=Time, y=value, color=sample))+
geom_point()+
xlim(8, 12)
chol_beta <- read_csv('/home/betaglutamate/OneDrive/00_PhD/00_Phd_data/01_Project_ChrHansen/2020_Osmolyte_response/20201027_new_platereader/20201028_betaine_choline/20201027_chr_beta_chol.csv')
chol_beta <- read_csv('/home/betaglutamate/OneDrive/00_PhD/00_Phd_data/01_Project_ChrHansen/2020_Osmolyte_response/20201027_new_platereader/20201028_betaine_choline/20201027_chr_beta_chol.csv')
chol_beta_growthrates <- readxl::read_xlsx('/home/betaglutamate/OneDrive/00_PhD/00_Phd_data/01_Project_ChrHansen/2020_Osmolyte_response/20201027_new_platereader/20201028_betaine_choline/curvefitter%20outputdata/20201027_chr_beta_chol_fitderiv Analysed.xlsx')
chol_beta_growthrates <- readxl::read_xlsx('/home/betaglutamate/OneDrive/00_PhD/00_Phd_data/01_Project_ChrHansen/2020_Osmolyte_response/20201027_new_platereader/20201028_betaine_choline/curvefitteroutputdata/20201027_chr_beta_chol_fitderiv Analysed.xlsx')
chol_beta_growthrates <- readxl::read_xlsx('/home/betaglutamate/OneDrive/00_PhD/00_Phd_data/01_Project_ChrHansen/2020_Osmolyte_response/20201027_new_platereader/20201028_betaine_choline/curvefitter outputdata/20201027_chr_beta_chol_fitderiv Analysed.xlsx')
chol_beta_growthrates
chol_beta_growthrates <- readxl::read_xlsx('/home/betaglutamate/OneDrive/00_PhD/00_Phd_data/01_Project_ChrHansen/2020_Osmolyte_response/20201027_new_platereader/20201028_betaine_choline/curvefitter outputdata/20201027_chr_beta_chol_fitderiv Analysed.xlsx') %>% rename(...1 = "index")
chol_beta_growthrates <- readxl::read_xlsx('/home/betaglutamate/OneDrive/00_PhD/00_Phd_data/01_Project_ChrHansen/2020_Osmolyte_response/20201027_new_platereader/20201028_betaine_choline/curvefitter outputdata/20201027_chr_beta_chol_fitderiv Analysed.xlsx') %>% rename(`...1` = "index")
chol_beta_growthrates
chol_beta_growthrates <- readxl::read_xlsx('/home/betaglutamate/OneDrive/00_PhD/00_Phd_data/01_Project_ChrHansen/2020_Osmolyte_response/20201027_new_platereader/20201028_betaine_choline/curvefitter outputdata/20201027_chr_beta_chol_fitderiv Analysed.xlsx') %>% rename("index"= ...1)
chol_beta_growthrates
#Chol_Beta
chol_beta <- read_csv('/home/betaglutamate/OneDrive/00_PhD/00_Phd_data/01_Project_ChrHansen/2020_Osmolyte_response/20201027_new_platereader/20201028_betaine_choline/20201027_chr_beta_chol.csv')
chol_beta_growthrates <- readxl::read_xlsx('/home/betaglutamate/OneDrive/00_PhD/00_Phd_data/01_Project_ChrHansen/2020_Osmolyte_response/20201027_new_platereader/20201028_betaine_choline/curvefitter outputdata/20201027_chr_beta_chol_fitderiv Analysed.xlsx') %>% rename("index"= ...1)
graph_theme <- theme_bw() +
theme(
plot.title = element_text(face = "plain", size = 10, hjust = 0.5),
legend.background = element_rect(fill = "white", size = 4, colour = "white"),
# legend.justification = c(0, 1),
# legend.position = c(0, 1),
axis.ticks = element_line(colour = "grey70", size = 0.2),
panel.grid.major = element_line(colour = "grey70", size = 0.2),
panel.grid.minor = element_blank(),
)
chol_beta_time = chol_beta[, 1, drop=F]
chol_beta_mean = rowMeans(chol_beta[1, 2:61])
chol_beta_subtracted = chol_beta[, 2:61]-chol_beta_mean
chol_beta = bind_cols(chol_beta_time, chol_beta_subtracted)
chol_beta_mid <-
chol_beta %>%
pivot_longer(2:61,names_to = 'sample') %>%
mutate(group = substr(sample,1,13)) %>%
rename(Time = 'Time [h]')
chol_beta_final <- chol_beta_mid %>%
mutate(Osmolyte = case_when(
str_detect(group, "ctrl") ~ "Control",
str_detect(group, "beta")  ~ "Betaine",
str_detect(group, "chol")  ~ "Choline",
TRUE ~ group
),
Osmolarity = as.numeric(substr(group, 5, 8)))
chol_beta_final
chol_beta_final %>%
group_by(Time, group) %>%
summarize(meanOD=mean(value), Osmolyte = unique(Osmolyte), Osmolarity = unique(Osmolarity), no = n()) %>%
ggplot(aes(x=Time, y=meanOD, color=group))+
geom_line()+
facet_wrap(~Osmolarity)
chol_beta_final %>%
group_by(Time, group) %>%
summarize(meanOD=mean(value), Osmolyte = unique(Osmolyte), Osmolarity = unique(Osmolarity), no = n()) %>%
ggplot(aes(x=Time, y=meanOD, color=group))+
geom_line()+
graph_theme+
facet_wrap(~Osmolarity)
chol_beta_final %>%
group_by(Time, group) %>%
summarize(meanOD=mean(value), Osmolyte = unique(Osmolyte), Osmolarity = unique(Osmolarity), no = n()) %>%
ggplot(aes(x=Time, y=meanOD, color=group))+
geom_line()+
graph_theme+
scale_color_manual(values = c("#00AFBB", "#E7B800", "#FC4E07"))+
facet_wrap(~Osmolarity)
chol_beta_final %>%
group_by(Time, group) %>%
summarize(meanOD=mean(value), Osmolyte = unique(Osmolyte), Osmolarity = unique(Osmolarity), no = n()) %>%
ggplot(aes(x=Time, y=meanOD, color=group))+
geom_line()+
graph_theme+
scale_color_manual(values = rep(c("#00AFBB", "#E7B800", "#FC4E07"),5))+
facet_wrap(~Osmolarity)
chol_beta_final %>%
group_by(Time, group) %>%
summarize(meanOD=mean(value), Osmolyte = unique(Osmolyte), Osmolarity = unique(Osmolarity), no = n()) %>%
ggplot(aes(x=Time, y=meanOD, color=group))+
geom_line()+
graph_theme+
scale_color_manual(values = rep(c("#00AFBB", "#E7B800", "#FC4E07"),6))+
facet_wrap(~Osmolarity)
chol_beta_final %>%
group_by(Time, group) %>%
summarize(meanOD=mean(value), Osmolyte = unique(Osmolyte), Osmolarity = unique(Osmolarity), no = n()) %>%
ggplot(aes(x=Time, y=meanOD, color=Osmolyte))+
geom_line()+
graph_theme+
scale_color_manual(values = rep(c("#00AFBB", "#E7B800", "#FC4E07"),6))+
facet_wrap(~Osmolarity)
chol_beta_growthrates
chol_beta_growthrates %>%
mutate(Osmolyte = case_when(
str_detect(Label, "ctrl") ~ "Control",
str_detect(Label, "beta")  ~ "Betaine",
str_detect(Label, "chol")  ~ "Choline",
TRUE ~ Label
),
Osmolarity = as.numeric(substr(group, 5, 8)))
chol_beta_growthrates %>%
mutate(Osmolyte = case_when(
str_detect(Label, "ctrl") ~ "Control",
str_detect(Label, "beta")  ~ "Betaine",
str_detect(Label, "chol")  ~ "Choline",
TRUE ~ Label
),
Osmolarity = as.numeric(substr(Label, 5, 8)))
chol_beta_growthrates %>%
mutate(Osmolyte = case_when(
str_detect(Label, "ctrl") ~ "Control",
str_detect(Label, "beta")  ~ "Betaine",
str_detect(Label, "chol")  ~ "Choline",
TRUE ~ Label
),
Osmolarity = as.numeric(substr(Label, 5, 8))) %>%
ggplot(aes(x=Time, y=meanOD, color=Osmolyte))+
geom_line()+
graph_theme+
scale_color_manual(values = rep(c("#00AFBB", "#E7B800", "#FC4E07"),6))+
facet_wrap(~Osmolarity)
chol_beta_growthrates
chol_beta_growthrates %>%
mutate(Osmolyte = case_when(
str_detect(Label, "ctrl") ~ "Control",
str_detect(Label, "beta")  ~ "Betaine",
str_detect(Label, "chol")  ~ "Choline",
TRUE ~ Label
),
Osmolarity = as.numeric(substr(Label, 5, 8))) %>%
ggplot(aes(y=GR, color=Osmolyte))+
geom_boxplot()+
graph_theme+
scale_color_manual(values = rep(c("#00AFBB", "#E7B800", "#FC4E07"),6))+
facet_wrap(~Osmolarity)
chol_beta_growthrates %>%
mutate(Osmolyte = case_when(
str_detect(Label, "ctrl") ~ "Control",
str_detect(Label, "beta")  ~ "Betaine",
str_detect(Label, "chol")  ~ "Choline",
TRUE ~ Label
),
Osmolarity = as.numeric(substr(Label, 5, 8))) %>%
ggplot(aes(x = Osmolarity, y=GR, color=Osmolyte))+
geom_boxplot()+
graph_theme+
scale_color_manual(values = rep(c("#00AFBB", "#E7B800", "#FC4E07"),6))+
facet_wrap(~Osmolarity)
chol_beta_growthrates %>%
mutate(Osmolyte = case_when(
str_detect(Label, "ctrl") ~ "Control",
str_detect(Label, "beta")  ~ "Betaine",
str_detect(Label, "chol")  ~ "Choline",
TRUE ~ Label
),
Osmolarity = as.numeric(substr(Label, 5, 8))) %>%
ggplot(aes(x = Osmolarity, y=GR, color=Osmolyte))+
geom_boxplot()+
graph_theme+
scale_color_manual(values = rep(c("#00AFBB", "#E7B800", "#FC4E07"),6))
chol_beta_growthrates %>%
mutate(Osmolyte = case_when(
str_detect(Label, "ctrl") ~ "Control",
str_detect(Label, "beta")  ~ "Betaine",
str_detect(Label, "chol")  ~ "Choline",
TRUE ~ Label
),
Osmolarity = as.numeric(substr(Label, 5, 8))) %>%
ggplot(aes(x = Osmolarity, y=GR, group= color=Osmolyte))+
chol_beta_growthrates %>%
mutate(Osmolyte = case_when(
str_detect(Label, "ctrl") ~ "Control",
str_detect(Label, "beta")  ~ "Betaine",
str_detect(Label, "chol")  ~ "Choline",
TRUE ~ Label
),
Osmolarity = as.numeric(substr(Label, 5, 8))) %>%
ggplot(aes(x = Osmolarity, y=GR, group=Osmolarity, color=Osmolyte))+
geom_boxplot()+
graph_theme+
scale_color_manual(values = rep(c("#00AFBB", "#E7B800", "#FC4E07")))
chol_beta_growthrates %>%
mutate(Osmolyte = case_when(
str_detect(Label, "ctrl") ~ "Control",
str_detect(Label, "beta")  ~ "Betaine",
str_detect(Label, "chol")  ~ "Choline",
TRUE ~ Label
),
Osmolarity = as.numeric(substr(Label, 5, 8)))
chol_beta_growthrates %>%
mutate(Osmolyte = case_when(
str_detect(Label, "ctrl") ~ "Control",
str_detect(Label, "beta")  ~ "Betaine",
str_detect(Label, "chol")  ~ "Choline",
TRUE ~ Label
),
Osmolarity = as.numeric(substr(Label, 5, 8))) %>%
ggplot(aes(x = Osmolarity, y=GR, group=interaction(Osmolarity, Osmolyte), color=Osmolyte))+
geom_boxplot()+
graph_theme+
scale_color_manual(values = rep(c("#00AFBB", "#E7B800", "#FC4E07")))
chol_beta_growthrates %>%
mutate(Osmolyte = case_when(
str_detect(Label, "ctrl") ~ "Control",
str_detect(Label, "beta")  ~ "Betaine",
str_detect(Label, "chol")  ~ "Choline",
TRUE ~ Label
),
Osmolarity = as.numeric(substr(Label, 5, 8))) %>%
ggplot(aes(x = Osmolarity, y=GR, group=interaction(Osmolarity, Osmolyte), color=Osmolyte))+
geom_boxplot()+
graph_theme+
scale_fill_manual(values = rep(c("#00AFBB", "#E7B800", "#FC4E07")))
e
chol_beta_final %>%
group_by(Time, group) %>%
summarize(meanOD=mean(value), Osmolyte = unique(Osmolyte), Osmolarity = unique(Osmolarity), no = n()) %>%
ggplot(aes(x=Time, y=meanOD, color=Osmolyte))+
geom_line()+
graph_theme+
scale_color_manual(values = rep(c("#00AFBB", "#E7B800", "#FC4E07"),6))+
facet_wrap(~Osmolarity)
chol_beta_final %>%
group_by(Time, sample) %>%
summarize(meanOD=mean(value), Osmolyte = unique(Osmolyte), Osmolarity = unique(Osmolarity), no = n()) %>%
ggplot(aes(x=Time, y=meanOD, color=Osmolyte))+
geom_line()+
graph_theme+
scale_color_manual(values = rep(c("#00AFBB", "#E7B800", "#FC4E07"),6))+
facet_wrap(~Osmolarity)
chol_beta_final %>%
group_by(Time, group) %>%
summarize(meanOD=mean(value), Osmolyte = unique(Osmolyte), Osmolarity = unique(Osmolarity), no = n()) %>%
ggplot(aes(x=Time, y=meanOD, color=Osmolyte))+
geom_line()+
graph_theme+
scale_color_manual(values = rep(c("#00AFBB", "#E7B800", "#FC4E07"),6))+
facet_wrap(~Osmolarity)
